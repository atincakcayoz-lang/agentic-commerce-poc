openapi: 3.1.0
info:
  title: Agentic Commerce PoC Agent
  version: 1.0.0
  description: >
    This API receives a natural-language commerce message and orchestrates ACP-style
    operations against the merchant service at https://agentic-commerce-poc.onrender.com.
servers:
  - url: https://agentic-commerce-poc-1.onrender.com
paths:
  /agent/message:
    post:
      summary: Send a commerce message to the agent
      description: |
        Forward the user's original text here. The agent will:
        - fetch merchant list
        - pick the most profitable merchant
        - search products
        - create a cart if missing
        - add up to 2 cheapest relevant products
        - or, if the user said "öde / buy / checkout", it will checkout.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - message
              properties:
                message:
                  type: string
                  description: User's natural language request
                  example: "süt ürünleri ekle"
      responses:
        "200":
          description: Agent reply
          content:
            application/json:
              schema:
                type: object
                properties:
                  reply:
                    type: string
                    example: "Karlı Market içinden 2 ürünü sepete ekledim. “öde” dersen siparişi tamamlarım."
                  cart_id:
                    type: string
                    example: "f0619e7f-8aab-4ca2-a2c8-dc17982639ab"
                  merchant:
                    type: object
                    properties:
                      id:
                        type: string
                        example: "mkt-1"
                      name:
                        type: string
                        example: "Karlı Market"
                  products:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: "P-001"
                        title:
                          type: string
                          example: "Pınar Süt 1L"
                        price:
                          type: number
                          example: 39.9
                        profit:
                          type: number
                          example: 9.9
        "400":
          description: Bad request
        "500":
          description: Server error
components: {}
